const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mkho0f1ahxn9k5n9.js","assets/lklglvrzltpv3f05.js","assets/c5btnvyxlzh1g9bg.js","assets/dr5q0mnwgdiuy1ac.js","assets/root-fllmzfn1.css","assets/evk8hxf7fhyx3i51.js","assets/fn5bn67vlrtkutmt.js","assets/conversation-small-bez2bigx.css","assets/kmcda7yv67z85pgk.js","assets/m97izhe8fz3kw6jj.js","assets/da2k7j3rsrmehnit.js","assets/iemp65u0gxli3qh8.js","assets/d7jbjrqfrctwofe7.js","assets/mxpmkwex47gr77n3.js","assets/heefrlxlra66lmjs.js","assets/jo8bsv1qkxqoovu7.js","assets/jxlaep7450nj06io.js","assets/lrqm1ostopufphid.js","assets/j9mxza4bsnsx0dvm.js","assets/i0ly2refky6ik5mr.js","assets/ckxtmp809sfjyjji.js","assets/f2pjbv4g5v6jtnmf.js","assets/i4htk5loe52vte0n.js","assets/opostyc9htpo5wrp.js","assets/dbdpekks3fw401z6.js","assets/lc3j1g825ii9f8e7.js","assets/demuoz4d7nhb3j9v.js"])))=>i.map(i=>d[i]);
import{aw as b,az as Q,g8 as K,eS as se,eT as ae,bk as ne,dN as te,eP as oe,dL as ie,bx as Y,bo as $,h as L,bv as re,g9 as le,a2 as ce,P as me,aV as y,aW as v,Z as de,d5 as ge,al as O,ex as fe}from"./dr5q0mnwgdiuy1ac.js";import{r as u,j as s,ad as P,ac as w,M}from"./lklglvrzltpv3f05.js";import{fS as F,fT as J,fU as ue,fV as pe,fW as xe,fX as he,fY as _e,Z as Ee,Y as ye,fZ as ve,F as Te,f_ as je,f$ as be,g0 as Ie,bW as n,g1 as Se,g2 as Ae,g3 as Ne,g4 as Re,g5 as we,g6 as Ce,fz as De}from"./fn5bn67vlrtkutmt.js";import{N as Pe}from"./kmcda7yv67z85pgk.js";const Oe=2e3,X=.4,Le=.45,Me=.2,ke=.1,Ve=.25;var N=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(N||{});function gs({conversationMessages:e,icon:o,status:a,text:g,estimatedToolDurationMs:p,animationLoopDurationMs:f=Oe,shouldPersistAfterFinished:r=!1}){const[c,i]=u.useState(a===0?0:a===1&&!r?7:1),[m,x]=u.useState(0);u.useEffect(()=>{a===2?i(8):a===3?i(9):a===4?i(10):a===1?i(c===2?3:7):a===0&&c===10&&(i(2),x(l=>l+1))},[a]);const d=ze(c);return u.useEffect(()=>{const l=e[0].message.id;if(d)return F.addDelayedRenderingMessage(l),()=>{F.removeDelayedRenderingMessage(l)}},[d]),J(()=>{R(c)&&x(l=>l+1)},f),c===7&&!r?null:s.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[s.jsx(Fe,{icon:o,status:a,uiState:c,estimatedToolDurationMs:p,animationLoopCounter:m,shouldPersistAfterFinished:r,onFillProgressBarAnimationComplete:()=>i(4),onFinishAnimationComplete:()=>{i(5),setTimeout(()=>{i(r?7:6)},ke*1e3)},onHideAnimationComplete:()=>i(7)}),s.jsx(Ue,{text:g,uiState:c,animationLoopCounter:m,onEnterAnimationComplete:()=>i(2)})]})}const U=50;function Fe({icon:e,status:o,uiState:a,estimatedToolDurationMs:g,animationLoopCounter:p,shouldPersistAfterFinished:f,onFillProgressBarAnimationComplete:r,onFinishAnimationComplete:c,onHideAnimationComplete:i}){const[m,x]=u.useState(0);J(()=>{R(a)?x(D=>D+U):a===10&&x(0)},U);let d,l,h;R(a)||a===10?(d="running",l=s.jsx(e,{animationLoopCounter:p}),h="bg-transparent"):a===4||a===5||a===7&&f?(d="finished",l=s.jsx(pe,{}),h="bg-brand-purple"):o===2?(d="error",l=s.jsx(xe,{}),h="bg-orange-500"):o===3&&(d="stopped",l=s.jsx(he,{}),h="bg-gray-300");let E={opacity:0,scale:0,rotate:-180,x:0},j={type:"spring",bounce:.3,duration:Le},I={opacity:0,scale:.6,rotate:0,x:0};a===0?(E={opacity:0,scale:.5,rotate:-180,x:-8},j={type:"spring",bounce:.3,duration:X}):a===1?E=!1:a===5&&(I={opacity:0,scale:0,rotate:0,x:0},j={type:"spring",bounce:.3,duration:Ve});const C=_e(m,g);return s.jsx("div",{className:"relative h-5 w-5 shrink-0",children:s.jsx(P,{onExitComplete:()=>{a===6&&i()},children:d!=null&&s.jsxs(w.div,{className:b("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",h),initial:E,animate:{opacity:1,scale:1,rotate:0,x:0},exit:I,transition:j,onAnimationComplete:()=>{a===4&&c()},children:[l,(R(a)||a===10)&&s.jsx(ue,{percentage:a===3?100:C,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:a===3?`${(100-C)/100*Me}s`:void 0,transitionTimingFunction:a===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{a===3&&r()}})]},d)})})}function Ue({text:e,uiState:o,animationLoopCounter:a,onEnterAnimationComplete:g}){const[p,f]=u.useState(e);u.useEffect(()=>{o===2&&f(e)},[a]),u.useEffect(()=>{R(o)||f(e)},[o,e]);let r={opacity:0,x:0,y:15},c={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};o===0?(r={opacity:0,x:-8,y:0},c={type:"spring",bounce:.3,duration:X,delay:.15}):o===1&&(r=!1);const i=p??void 0;return s.jsx("div",{className:b("relative h-5 w-full leading-5",o===8||o===9?"text-token-text-tertiary":"text-token-text-secondary"),children:s.jsx(P,{children:i!=null&&s.jsx(w.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:r,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:c,onAnimationComplete:()=>{o===0&&g()},children:i},i.toString())})})}function R(e){return e===0||e===2||e===3}function ze(e){return R(e)||e===4||e===5||e===6||e===10}const z=Q.div`group absolute left-0 top-0 mr-1.5 h-8 overflow-hidden mt-1`;function Be({highlightedCommand:e,status:o,children:a,showWorkUserSetting:g=!1,hideOnlyIfNotInteractedWith:p=!1,onOpenAnalytics:f,onClick:r}){const c=a!=null||r!=null,[i]=u.useState(g),[m,x]=u.useState(g),[d,l]=u.useState(!1),h=o===N.Finished||o===N.Error,E=p?i?!1:!d:!1,j=o===N.Running&&"loading-shimmer";return h&&E?null:c?s.jsxs(s.Fragment,{children:[s.jsx(B,{$canShowWork:!0,children:s.jsx(P,{children:s.jsx(z,{children:s.jsx(w.button,{onClick:()=>{m||f?.(),x(I=>!I),l(!0),r?.()},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:b(j),children:s.jsxs("div",{className:"flex items-center justify-start gap-1",children:[s.jsx("span",{children:e}),!r&&(m?s.jsx(Ee,{className:"icon-md"}):s.jsx(ye,{className:"icon-md"}))]})},e?.toString())})})}),s.jsx(P,{children:m&&a&&s.jsx(w.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:a})})]}):s.jsx(B,{$canShowWork:!1,children:s.jsx(z,{className:b(j),children:e})})}const B=Q.span`block first:mt-0 relative h-8
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,We=3,He=.1,W=[0,.26,.4];function Qe({nextMessage:e,isLastMessage:o,isRequestActive:a,isLastTurnInConversation:g,clientThreadId:p,turnIndex:f}){let r=o||!e||e&&!K(e.message);const c=se(e?.message),i=ae(e?.message);e?.message.id&&ve(e?.message.id);const m=[];if(i?.[0]?.type==="navigation"&&e&&m.push(s.jsx(Ke,{clientThreadId:p,turnIndex:f,nextMessage:e,isRequestActive:a,isLastTurnInConversation:g,navigationCitation:i[0]},"fast-nav")),r){const x=ne(c.slice(0,We).map(l=>l.entries[0].url)),d=a?s.jsxs("div",{className:"flex items-center gap-1",children:[x.map((l,h)=>s.jsx(w.div,{className:b("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:h===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:He,delay:W[Math.min(h,W.length-1)]},children:s.jsx("div",{className:b("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:s.jsx(Te,{url:l,size:32,minSize:16,className:"icon-md rounded-full"})})},l)),s.jsx(M,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):s.jsx(M,{id:"fssXGM",defaultMessage:"Error while searching"});m.push(s.jsx(Be,{highlightedCommand:d,status:a?N.Running:N.Error},"search-gpt-query"))}return m.length?s.jsx(s.Fragment,{children:m}):null}const Ke=({clientThreadId:e,turnIndex:o,nextMessage:a,isRequestActive:g,isLastTurnInConversation:p,navigationCitation:f})=>{const{scrollToHeader:r}=te("searchSources")??{},c=oe(),i=ie()&&c?.type==="searchSources",{openThreadSidebar:m}=Y(),{value:x}=$("756982148");return u.useEffect(()=>{i&&m({type:"searchSources",scrollToHeader:r,clientThreadId:e,turnIndex:o,messageId:a?.message.id??""})},[]),u.useEffect(()=>{const d=a.message,l=d.metadata?.search_source,h=f.domains.map(E=>E.url);je.logEvent(L.searchToolRequestTimeToFastNav,e,d.id,{search_source:l,urls:h},()=>{l===re.InstantQuery&&be.logEvent(L.searchToolPageLoadTimeToFastNav,{message_id:d.id,urls:h})})},[e,a,f]),g&&p&&x?s.jsx(w.div,{initial:{opacity:g?0:1,height:g?0:"auto"},animate:{opacity:1,height:"auto"},children:s.jsx(H,{clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:f})}):s.jsx(H,{clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:f})},H=({clientThreadId:e,turnIndex:o,nextMessage:a,navigationCitation:g})=>{const{toggleThreadSidebar:p}=Y(),{value:f}=$("756982148"),r=u.useMemo(()=>({clientThreadId:e,turnIndex:o,messageId:a?.message.id}),[e,o,a?.message.id]),c=u.useCallback((x,d)=>{p({type:"searchSources",scrollToHeader:d,clientThreadId:e,turnIndex:o,messageId:a?.message.id??""})},[p,e,o,a?.message.id]),i=u.useRef(!1),m=u.useCallback((x,d,l,h)=>{if(r&&r.messageId&&le(r.messageId)&&(!i.current||x!==L.searchContentReferenceShown)){i.current=!0;const E={...ce(r),type:l,index:0,...h??{}};me.logEventWithStatsig(x,d,E)}},[r]);return f?s.jsx(Pe,{navigation:g,onShowSearchResults:c,trackContentReferenceEvent:m}):s.jsx(Ie,{tldr:{type:"tldr",display_title:g.domains[0].title,url:g.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[g.domains[0].domain]},trackContentReferenceEvent:m})},Ye=y(()=>v(()=>import("./mkho0f1ahxn9k5n9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),$e=y(()=>v(()=>import("./m97izhe8fz3kw6jj.js"),__vite__mapDeps([9,1,3,4,10]))),Je=y(()=>v(()=>import("./iemp65u0gxli3qh8.js"),__vite__mapDeps([11,1,3,4,6,7]))),Xe=y(()=>v(()=>import("./d7jbjrqfrctwofe7.js"),__vite__mapDeps([12,1,3,4,6,7])).then(e=>e.TextMessageEditor)),Ze=y(()=>v(()=>import("./mxpmkwex47gr77n3.js"),__vite__mapDeps([13,1,3,4,14,6,7,15,2,5,16,17,8]))),Ge=y(async()=>()=>null),qe=y(()=>v(()=>import("./j9mxza4bsnsx0dvm.js"),__vite__mapDeps([18,1,3,4,6,7,8]))),es=y(()=>v(()=>import("./i0ly2refky6ik5mr.js"),__vite__mapDeps([19,1,3,4,6,7,20,8])).then(e=>e.BrowsingMessage)),ss=y(()=>v(()=>import("./f2pjbv4g5v6jtnmf.js"),__vite__mapDeps([21,1,3,4,6,7])).then(e=>e.SearchResultMessage)),as=y(()=>v(()=>import("./i4htk5loe52vte0n.js"),__vite__mapDeps([22,1,3,4,6,7,8])).then(e=>e.JITPluginMessage)),ns=y(()=>v(()=>import("./opostyc9htpo5wrp.js"),__vite__mapDeps([23,3,1,4,6,7,8])).then(e=>e.DataAnalysisMessage)),ts=y(()=>v(()=>import("./dbdpekks3fw401z6.js"),__vite__mapDeps([24,1,3,4,16,6,7,25,26,8])));function fs(e){switch(e.type){case n.Text:case n.Debug:return[e.message];case n.MultiText:case n.Browsing:case n.CodeInterpreter:case n.JITPlugin:case n.RetrievalBrowsing:case n.ParallelBrowsing:case n.Dalle:case n.GizmoEditor:case n.SearchResult:case n.a8km123:case n.f959b8c:case n.b1de6e2:case n.b1de6e2_c:case n.Canmore:case n.SonicCanvas:case n.de1d73e:case n.SearchGPTQuery:case n.oiw209h:return e.messages;default:throw new Error("Bad")}}function us({groupedMessagesToRender:e,allGroupedMessages:o,clientThreadId:a,isEditing:g,isUserTurn:p,isCompletionRequestInProgress:f,isFeedbackEnabled:r,isFinalTurn:c,turnIndex:i,hasActiveRequest:m,showEditButton:x=!1,handleEnterEdit:d,handleExitEdit:l,onChangeItemInView:h,onRequestMoreCompletions:E,onRequestCompletion:j,shouldGrowContainer:I=!0}){const{showDebugConversationTurns:C}=Se(),D=de(a),k=ge(a),Z=o.some(t=>Ae.includes(t.type)),G=e.map((t,_)=>{const S=_===o.length-1;switch(t.type){case n.Text:case n.MultiText:{const T=e[_-1],A=T?.type,V=T&&"messages"in T?T.messages:void 0;if(t.type===n.Text){const q=t?.message&&!K(t.message.message),ee=g?s.jsx(Xe,{message:t.message,clientThreadId:a,onChangeItemInView:h,onRequestCompletion:j,onRequestMoreCompletions:E,onExitEdit:l,disabled:m}):Z&&q?null:s.jsx(we,{className:"min-h-8",message:t.message,isFeedbackEnabled:r,isCompletionInProgress:S&&f,turnIndex:i,clientThreadId:a,showEditButton:x,onEnterEdit:d,isUserTurn:p,onRequestMoreCompletions:E,prevGroupedMessageType:A,prevGroupedMessages:V});return s.jsxs(u.Fragment,{children:[ee,s.jsx(Ce,{isUserTurn:p,message:t.message.message})]},"group-"+t.message.nodeId)}else return t.type===n.MultiText?s.jsx(Je,{clientThreadId:a,messages:t.messages,isCompletionInProgress:S&&f,isFeedbackEnabled:r,onRequestMoreCompletions:E,prevGroupedMessageType:A,prevGroupedMessages:V},"multitext-"+(t.messages[0]?.nodeId??_)):t.type}case n.Browsing:case n.RetrievalBrowsing:{const T=D!=null&&[O.GizmoInteraction,O.GizmoMagicCreate,O.GizmoTest].includes(D.kind),A=k?Re(k):!1;return s.jsx(es,{messages:t.messages,isRequestActive:m,isLastMessageInTurn:S,isUsingGizmo:T,isUsingSnorlax:A,isRetrieval:t.type===n.RetrievalBrowsing},"browsing-"+(t.messages[0]?.nodeId??_))}case n.SearchGPTQuery:{const T=o.slice(_+1).find(A=>A.type===n.Text);return s.jsx(Qe,{clientThreadId:a,turnIndex:i,isRequestActive:m,isLastMessage:S,isLastTurnInConversation:c,nextMessage:T&&T.type===n.Text?T.message:void 0},"searchquery-"+(t.messages[0]?.nodeId??_))}case n.a8km123:return s.jsx(ts,{messages:t.messages,isStreaming:S&&f,isLastMessage:S,clientThreadId:a,currentGroupedMessageIndex:_,turnIndex:i},"sum-"+(t.messages[0]?.nodeId??_));case n.f959b8c:return null;case n.b1de6e2:return null;case n.b1de6e2_c:return null;case n.de1d73e:return null;case n.ParallelBrowsing:return s.jsx(qe,{messages:t.messages},"parallel-"+(t.messages[0]?.nodeId??_));case n.CodeInterpreter:return s.jsx(ns,{messages:t.messages,isRequestActive:m,clientThreadId:a},"ada-"+(t.messages[0]?.nodeId??_));case n.JITPlugin:return s.jsx(as,{messages:t.messages,clientThreadId:a,isLastTurnInConversation:c,onRequestCompletion:j},"jit-"+(t.messages[0]?.nodeId??_));case n.Dalle:return s.jsx(Ze,{messages:t.messages,clientThreadId:a},"dalle-"+(t.messages[0]?.nodeId??_));case n.GizmoEditor:return s.jsx(Ye,{messages:t.messages},"gizmo-editor-"+(t.messages[0]?.nodeId??_));case n.oiw209h:return s.jsx(Ge,{messages:t.messages,clientThreadId:a},"oiw209h-"+(t.messages[0]?.nodeId??_));case n.Canmore:return s.jsx(Ne,{messages:t.messages,allGroupedMessages:e,isFinalTurn:c,isRequestActive:m,clientThreadId:a},"canmore-"+(t.messages[0]?.nodeId??_));case n.SonicCanvas:return!1;case n.Debug:return C?s.jsx($e,{message:t.message},"debug-"+t.message.nodeId):null;case n.SearchResult:return s.jsx(ss,{messages:t.messages},"search-result-"+(t.messages[0]?.nodeId??_))}});return s.jsx(is,{shouldGrowContainer:I,children:G})}function os(){return s.jsx(De,{type:"danger",children:s.jsx(M,{id:"daIg0P",defaultMessage:"Unable to display this message due to a error."})})}function is({children:e,shouldGrowContainer:o}){return s.jsx("div",{className:b({"flex max-w-full flex-col":!0,"flex-grow":o}),children:s.jsx(fe,{name:"GroupedMessages",fallback:os,children:e})})}export{us as C,N as T,Be as a,gs as b,fs as g};
//# sourceMappingURL=oggr4qblywivx1kc.js.map
