import{r as h,j as e,c as D,M as x,v as oe,f as Pe,L as Te}from"./lklglvrzltpv3f05.js";import{eG as Ee,fa as A,be as c,hM as _e,hN as U,hO as Oe,hP as re,hQ as De,hR as L,hS as ae,hT as ie,hU as _,hV as Ae,hW as le,hu as Ue,eZ as Le,hX as Be,hY as Re,hZ as Ge,h_ as ze,h$ as He,i0 as Xe,i1 as Ze,i2 as q,e_ as Ve,i3 as z,i4 as ee,i5 as We,i6 as H,bC as Qe,i7 as Ye,i8 as $e,eL as Z,i9 as Je,aS as Ke,ia as qe,ib as ce,ic as es,id as ss,ie as de,cM as ts,dR as ns,ig as os,eJ as rs,ih as as,ii as is,hz as ls,fd as cs,hi as ds,dw as us,ij as ms,ik as xs,il as hs,k as fs,im as se,io as ps,ip as gs}from"./fn5bn67vlrtkutmt.js";import{aw as S,ch as ue,az as B,V as js,F as V,bP as O,bO as me,b0 as X,P as xe,h as he,b5 as vs,e1 as fe,b_ as bs,br as ys,c0 as Ss,bE as Ns,v as G,bo as Cs,bg as ks,fH as ws,d_ as Is}from"./dr5q0mnwgdiuy1ac.js";import{S as Fs}from"./od0q70ax7x1slg7q.js";import{F as Ms}from"./ij9alyrznoq1jror.js";import{P as Ps,f as Ts,G as Es}from"./e0j7g4azm9nlvt6p.js";import"./kwfnt7q4maeym4cv.js";import"./oggr4qblywivx1kc.js";import"./kmcda7yv67z85pgk.js";import"./fbu84jjzpk28uqob.js";import"./gvzs5psd5zlducxo.js";import"./cuav3gl4u7ecbt92.js";const _s=[null,"#F14D42","#E36E30","#B98618","#DB9F1E","#3DCB40","#30A633","#27C0A6","#16B7DB","#6490F0","#0088FF","#1D53BF","#512AEB","#875BE1","#EE4D83","#E659C2"];function Os({color:s,active:n,onClick:t}){const o=D();return e.jsx("button",{onClick:()=>t(s),className:"flex h-10 w-10 items-center justify-center rounded-full bg-token-text-primary can-hover:hover:scale-110 can-hover:active:scale-100","aria-label":s??o.formatMessage(c.defaultColor),style:{backgroundColor:s??void 0},children:n&&e.jsx(_e,{className:"h-6 w-6 text-token-main-surface-primary"})})}function Ds({currentTheme:s,onSelect:n}){return e.jsx("div",{className:"m-4 grid grid-cols-4 gap-4",children:_s.map(t=>e.jsx(Os,{active:t===s,color:t,onClick:o=>{n(o)}},t))})}const As=({currentTheme:s,isPopoverOpen:n,disabled:t,...o},a)=>e.jsxs("button",{ref:a,disabled:t,...o,className:S("group relative flex h-[60px] w-[60px] items-center justify-center",t&&"pointer-events-none"),children:[e.jsx("div",{className:S("absolute flex h-full w-full items-center justify-center rounded-full",s&&"opacity-10",!s&&"bg-token-main-surface-secondary"),style:{backgroundColor:s??void 0}}),e.jsx("div",{className:"relative flex h-full w-full items-center justify-center",children:e.jsx(Ee,{className:S("icon-lg duration-200 ease-out can-hover:group-hover:scale-110",t&&"text-token-text-tertiary"),style:{color:s}})}),e.jsx("div",{className:S("absolute bottom-0 right-0 flex h-6 w-6 scale-0 items-center justify-center rounded-full border border-token-border-light bg-token-main-surface-primary text-token-text-secondary opacity-0 drop-shadow-sm duration-200 ease-out group-hover:scale-100 group-hover:opacity-100",n&&"scale-100"),children:e.jsx(A,{className:"h-[18px] w-[18px] rounded-full text-token-text-secondary"})})]}),pe=h.forwardRef(As);function W({file:s,fileName:n,fileId:t,gizmoId:o}){const a=U(n)&&t!=null,r=Oe(s&&re(s)?s:null,n,t,o,void 0);return a?e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-[#129FBF] bg-cover bg-center text-white",style:{backgroundImage:`url(${r})`},children:!r&&e.jsx(De,{className:"icon-lg"})}):null}function Us({gizmoId:s,gizmoName:n,pendingFiles:t,files:o,modelCapacityUsed:a,interpreterOnlyFileIds:r,onAddFiles:l,removePendingFile:d,pendingFileUpsertMutationsRef:i}){return t.length===0&&o.length===0?e.jsx("div",{className:"h-full pb-6",children:e.jsx(Gs,{gizmoName:n,onAddFiles:l})}):e.jsx("div",{className:"pb-6",children:e.jsx(Ls,{gizmoId:s,modelCapacityUsed:a,files:o,pendingFiles:t,interpreterOnlyFileIds:r,removePendingFile:d,pendingFileUpsertMutationsRef:i})})}function Ls({gizmoId:s,modelCapacityUsed:n,files:t,pendingFiles:o,interpreterOnlyFileIds:a,removePendingFile:r,pendingFileUpsertMutationsRef:l}){const d=L();return t.length===0&&o.length===0?null:e.jsxs("div",{className:"overflow-hidden rounded-lg border border-token-border-light",children:[n&&n>1?e.jsxs("div",{className:"border-b border-token-border-light bg-gray-50 px-4 py-3 text-xs text-token-text-secondary dark:bg-gray-750",children:[e.jsx("div",{className:"font-medium",children:e.jsx(x,{...c.tooManyFilesTitle})}),e.jsx("div",{children:e.jsx(x,{...c.tooManyFilesDescription})})]}):null,t.map(i=>e.jsx(Rs,{gizmoId:s,gizmoFile:i,interpreterOnly:a.includes(i.file_id),onDelete:async()=>{const u=new Promise(p=>{l.current.push({id:s,mutationId:oe(),update:j=>{const g=j.files.filter(v=>v.file_id!==i.file_id);return{...j,files:g}},onSuccess:p})});return ae(s)({gizmoId:s,upsertProjectMutation:d,pendingFileUpsertMutationsRef:l}),u}},i.file_id)),o.map(i=>e.jsx(Bs,{interpreterOnly:a.includes(i.tempId),pendingFile:i,onDelete:async()=>r(i.tempId)},i.tempId))]})}function ge(){return e.jsx("div",{className:"truncate",children:e.jsx(x,{...c.interpreterOnlyLabel})})}function Bs({pendingFile:s,onDelete:n,interpreterOnly:t}){const o=s.file.name,r=(re(s.file)&&s.file?.type.startsWith("image/")||U(o))&&e.jsx(W,{file:s.file,fileName:o,fileId:s.fileId??void 0,gizmoId:s.gizmoId??void 0});return e.jsx(je,{interpreterOnly:t,onDelete:n,children:e.jsx(ie,{icon:r,fileName:s.file.name,loadingPercentage:s.status===_.Uploading?s.progress:void 0,customFileDescription:t?e.jsx(ge,{}):void 0})})}function Rs({gizmoFile:s,gizmoId:n,interpreterOnly:t,onDelete:o}){const a=s.name,l=U(a)&&s.file_id!=null&&e.jsx(W,{fileName:a,fileId:s.file_id,gizmoId:n});return e.jsx(je,{interpreterOnly:t,onDelete:o,children:e.jsx(ie,{icon:l,fileName:s.name,customFileDescription:t?e.jsx(ge,{}):void 0})})}function je({children:s,onDelete:n,interpreterOnly:t}){const[o,a]=h.useState(!1);return e.jsxs("div",{className:S("group flex w-full justify-between border-b border-token-border-light p-3 text-sm last:border-b-0",t&&"grayscale"),children:[e.jsx("div",{className:"w-10/12 can-hover:w-full can-hover:group-hover:w-11/12",children:s}),e.jsx("div",{className:S("flex shrink-0 grow-0 bg-token-main-surface-primary pl-1 can-hover:group-hover:flex",!o&&"can-hover:hidden"),children:o?e.jsx("div",{className:"flex h-full w-6 items-center justify-center",children:e.jsx(ue,{})}):e.jsx("button",{onClick:async()=>{n&&(a(!0),await n(),a(!1))},children:e.jsx(Ae,{className:"text-token-secondary rounded-full hover:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-tertiary"})})})]})}function Gs({gizmoName:s,onAddFiles:n}){return e.jsx("div",{className:"flex h-full cursor-pointer items-center justify-center rounded-lg border border-token-border-light px-4 py-3 pb-6 active:bg-token-main-surface-tertiary",onClick:n,children:e.jsxs("div",{className:"flex flex-col items-center gap-2 py-4 text-sm text-token-text-secondary",children:[e.jsx(le,{}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"max-w-100 text-token-text-secondary",children:e.jsx(x,{...c.emptyFileInstructions,values:{gizmoNameText:e.jsx("span",{className:"font-bold",children:e.jsx(x,{...c.emptyFileGizmoName,values:{gizmoName:s}})},"gizmoNameText")}})})})]})})}const ve=B.div`text-sm text-red-500`,zs=B.textarea`w-full overflow-y-auto overflow-x-clip rounded-lg border px-3 py-2 focus:ring-2 focus:ring-token-text-primary border-token-border-medium bg-token-main-surface-primary`,E=20;function be({onClose:s,gizmo:n}){const t=D(),[o,a]=h.useState(n?.gizmo?.instructions||""),r=L(),l=V(),d=[];o?.length>z&&d.push(t.formatMessage(c.instructionsTooLong,{length:z}));const i=g=>{a(g.target.value)},u=()=>{s()},m=async()=>{try{await r.mutateAsync({update:{instructions:o??""},id:n.gizmo.id}),s()}catch(g){const v=fe(g);l.danger(v??"Error",{duration:2})}},p=e.jsx(O.Button,{title:t.formatMessage(c.save),color:"primary",onClick:m,loading:r.isPending,disabled:d.length>0}),j=e.jsx(O.Button,{title:t.formatMessage(c.cancel),color:"secondary",onClick:u,disabled:r.isPending});return e.jsx(me,{className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!r.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:e.jsx("div",{className:"h-8",children:t.formatMessage(c.editCustomInstructionsTitle)}),onClose:()=>{r.isPending||s()},children:e.jsxs("div",{className:"flex h-full flex-col px-6 pb-7 pt-0",children:[e.jsx("div",{className:"text-sm font-medium",children:t.formatMessage(c.editCustomInstructionsSubtitle)}),e.jsx("div",{className:"text-sm text-token-text-secondary",children:t.formatMessage(c.editCustomInstructionsDescription)}),e.jsx(zs,{autoFocus:!0,placeholder:t.formatMessage(c.projectInstructionsPlaceholder),className:"mb-1 mt-4 min-h-24 w-full flex-grow resize-none rounded-md bg-token-main-surface-primary",onChange:i,value:o,disabled:r.isPending}),d.map(g=>e.jsx(ve,{className:"mt-1",children:g},g)),e.jsx(O.Actions,{primaryButton:p,secondaryButton:j})]})})}function Hs({gizmoId:s,gizmoName:n,gizmoEditorData:t,openFileDialog:o,pendingFiles:a,setVersion:r,pendingFileUpsertMutationsRef:l,currentModelConfig:d}){const i=t?.files?.reduce((f,k)=>f+(k.file_size_tokens??0),0)??0,u=t?.contextStuffingBudget;let m;u&&(m=i/u,i>0&&m<.01&&(m=.01));const p=t?.files??[],j=Array.from(a.current.values()).filter(f=>p.every(k=>k.file_id!==f.fileId)),g=j.filter(f=>d!=null&&H(d,f.file.type,f.file.name)===X.CodeInterpreter),v=p.filter(f=>d!=null&&f.type!=null&&H(d,f.type,f.name)===X.CodeInterpreter),b=[...g.map(f=>f.tempId),...v.map(f=>f.file_id)];return e.jsx(Us,{gizmoId:s,gizmoName:n,pendingFiles:j,pendingFileUpsertMutationsRef:l,files:p,modelCapacityUsed:m,interpreterOnlyFileIds:b,onAddFiles:o,removePendingFile:f=>{a.current.delete(f),r(k=>k+1)}})}const Xs=h.forwardRef(function({gizmo:n,showInstructions:t=!0},o){const a=D(),[r,l]=h.useState(!1),d=L(),i=Ue(n),u=Le(i),{data:m}=Be(),p=m?.modelsList.find(N=>N.tags.includes(js.GPT_4o))??m?.modelsList.find(N=>N.id===Re),j=V(),[g,v]=h.useState(0),b=h.useRef(new Map),f=h.useRef([]),k=Ge(p,void 0),Ne=N=>{N.some(({errors:I})=>I.length!==1||I[0]?.code!==q.TooManyFiles)?j.danger(a.formatMessage(c.unknownError),{duration:2}):j.danger(a.formatMessage(c.dragTooManyFilesError,{MAX_FILES_PER_PROJECT:E}),{duration:2})},Ce=async N=>{xe.logEvent(he.uploadFile,{client:"web",eventSource:"mouse",intent:"gizmo"});const I=i.id;N.length>0&&await Promise.all(N.map(F=>{const R=Qe(F);b.current.set(R,{tempId:R,gizmoId:I,file:F,status:_.Uploading,progress:1,fileId:null,cdnUrl:null}),Ye(R,F,a,j,{kind:vs.Gizmo,gizmoId:I},{onFileUploaded:async(y,w,P,M)=>{const C=b.current.get(y);C?.fileId&&C?.fileId&&(f.current.push({id:n.gizmo.id,mutationId:oe(),update:T=>{if(!C.fileId)return T;const Me=[...T.files??[],{file_id:C.fileId,name:C.file.name,size:C.file.size,type:M?.mimeType??$e(C.file),last_modified:C.file.lastModified,file_size_tokens:M?.fileTokenSize}];return{...T,files:Me}},onSuccess:()=>{b.current.delete(y),v(T=>T+1)}}),ae(n.gizmo.id)({gizmoId:n.gizmo.id,upsertProjectMutation:d,pendingFileUpsertMutationsRef:f}))},onFileCreated:(y,w,P)=>{b.current.set(y,{tempId:y,gizmoId:I,file:F,status:_.Uploading,progress:1,...b.current.get(y),fileId:w,cdnUrl:P}),v(M=>M+1)},onFileUploadProgress:(y,w)=>{const P=b.current.get(y);P?.status===_.Uploading&&b.current.set(y,{...P,progress:w>95?95:w}),v(M=>M+1)},onError:y=>{b.current.delete(y),v(w=>w+1)}},{usesRetrievalIndex:p!=null&&H(p,F.type,F.name)===X.Retrieval})}))},Y=ze(k),$=He(Y),J=b.current.size+i.files.length,{open:K,getInputProps:ke,getRootProps:we,isDragAccept:Ie,isDragReject:Fe}=Xe({noClick:!0,noDragEventsBubbling:!0,onDropAccepted:Ce,onDropRejected:Ne,multiple:!0,maxSize:Ze,maxFiles:E-J,validator:()=>J>=E?{code:q.TooManyFiles,message:"Too many files"}:null,...Y});return h.useImperativeHandle(o,()=>({openFileDialog:K})),e.jsxs("div",{...we({className:"h-full px-6"}),children:[e.jsx("input",{...ke()}),t&&e.jsxs(Ms,{children:[e.jsx("button",{className:"w-full",onClick:()=>l(!0),children:e.jsx("div",{className:"w-full rounded-lg border border-token-border-light text-left text-sm",children:i?.instructions?.length?e.jsx("div",{className:"mx-4 my-3 line-clamp-4",children:i.instructions}):e.jsxs("div",{className:"flex h-full w-full items-center px-4 py-3 text-token-text-secondary",children:[e.jsx("div",{className:"flex-1",children:e.jsx(x,{...c.addCustomInstructions})}),e.jsx(A,{className:"icon-sm"})]})})}),u.includes(Ve.GizmoInstructionsTooLong)?e.jsx(ve,{className:"mt-1",children:e.jsx(x,{...c.instructionsTooLong,values:{length:z}})}):null]}),r&&e.jsx(be,{gizmo:n,onClose:()=>{l(!1)}}),e.jsx(Hs,{gizmoId:n.gizmo.id,gizmoName:n.gizmo.display.name,gizmoEditorData:i,openFileDialog:K,pendingFiles:b,pendingFileUpsertMutationsRef:f,setVersion:v,currentModelConfig:p}),Ie&&e.jsxs(ee,{children:[e.jsx(We,{}),e.jsx("h3",{children:e.jsx(x,{...c.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:$.length>0?$.join(", "):e.jsx(x,{...c.dragAllAccepted})})]}),Fe&&e.jsxs(ee,{children:[e.jsx(Fs,{className:"icon-2xl"}),e.jsx("h3",{children:e.jsx(x,{...c.dragTooManyFiles})}),e.jsx("h4",{className:"w-2/3 text-center",children:e.jsx(x,{...c.dragTooManyFilesDescription,values:{MAX_FILES_PER_PROJECT:E}})})]})]})});function Zs({gizmo:s,onClose:n}){const t=h.useRef(null),o=h.useCallback(()=>{t.current?.openFileDialog()},[t]);return e.jsx(e.Fragment,{children:e.jsx(me,{className:"min-h-72 max-w-[820px]",isOpen:!0,showCloseButton:!0,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",onClose:()=>{n()},children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx(O.TitleBar,{$hasSeparator:!1,children:e.jsxs("div",{className:"flex w-full items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(bs,{className:"text-lg font-semibold leading-6 text-token-text-primary",children:e.jsx(x,{...c.projectFilesModalTitle})})}),e.jsx(ys,{color:"secondary",onClick:o,children:e.jsx(x,{...c.addFilesButtonLabel})}),e.jsx(Ss,{asChild:!0,className:"sm:mt-0",children:e.jsx(Ns,{onClick:n})})]})}),e.jsx("div",{className:"h-[50dvh] flex-grow overflow-y-auto pt-0",children:e.jsx(Xs,{ref:t,gizmo:s,showInstructions:!1})})]})})})}function Vs({gizmo:s}){return e.jsx("div",{className:"mt-6 grid grid-cols-1 items-start gap-5 xs:grid-cols-2",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ws,{gizmo:s}),e.jsx(Ys,{gizmo:s})]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{}),e.jsx(te,{})]})})}function Q({header:s,context:n,contextClassName:t="",icon:o,modal:a,onClick:r,disabled:l=!1,isModalOpen:d=!1}){return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:S("group/snorlax-control-tile relative h-full rounded-2xl border border-token-border-xlight bg-token-main-surface-primary shadow-xxs hover:bg-token-main-surface-secondary active:bg-token-main-surface-tertiary active:drop-shadow-none",l&&"pointer-events-none"),children:e.jsxs("div",{className:"relative mx-5 my-4 flex items-center justify-between gap-3 overflow-hidden",children:[e.jsxs("div",{className:"w-full grow text-left",children:[e.jsx("div",{className:"text-sm font-medium",children:s}),e.jsx("div",{className:S("text-xs text-token-text-secondary",t),children:n})]}),o]})}),d&&a]})}function te(){return e.jsx(Q,{disabled:!0,header:e.jsx("div",{className:"my-2 h-2 w-48 rounded-full bg-token-main-surface-secondary"}),context:e.jsx("div",{className:"my-2 h-2 w-32 rounded-full bg-token-main-surface-secondary"})})}function Ws({gizmo:s}){const{files:n}=s,t=!n.length,o=Z(s.gizmo.id),[a,r]=h.useState(!1),l=a&&e.jsx(Zs,{gizmo:s,onClose:()=>{r(!1)}}),d=()=>r(!0);let i,u,m;if(t)i=e.jsx(x,{...c.addFilesButtonLabel}),u=e.jsx(x,{...c.filesControlDescription}),m=e.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[e.jsx("div",{className:"absolute h-full w-full rounded-full bg-token-main-surface-secondary opacity-5",style:{backgroundColor:o??void 0}}),e.jsx(le,{className:"icon-md h-5 w-5",style:{color:o}})]});else{const j=n.slice(0,3);i=e.jsx(x,{...c.projectFilesModalTitle}),u=e.jsx(x,{...c.filesCount,values:{count:n.length}}),m=e.jsx("div",{className:"relative flex h-10 w-20 shrink-0 items-center justify-center rounded-full",children:j.toReversed().map((g,v)=>e.jsx(Qs,{file:g,index:v,gizmoId:s.gizmo.id},g.id))})}return e.jsx(Q,{isModalOpen:a,modal:l,onClick:d,header:i,context:u,icon:m})}function Qs({file:s,index:n,gizmoId:t}){const o=s.name,r=U(o)&&s.file_id!=null&&e.jsx(W,{fileName:o,fileId:s.file_id,gizmoId:t});return e.jsx("div",{className:"absolute right-0 top-0 h-10 w-10 overflow-hidden rounded-xl border-2 border-token-main-surface-primary group-hover/snorlax-control-tile:border-token-main-surface-secondary",style:{transform:`translateX(${n*-20}px)`},children:r||e.jsx(Je,{className:"h-9 w-9 flex-shrink-0",filename:s.name,contextConnectorInfo:void 0})})}function Ys({gizmo:s}){const{instructions:n}=s.gizmo,t=!n.length,o=Z(s.gizmo.id),[a,r]=h.useState(!1),l=a&&e.jsx(be,{gizmo:s,onClose:()=>{r(!1)}}),d=()=>r(!0);let i,u,m,p;return t?(i=e.jsx(x,{...c.customInstructionsTitle}),u=e.jsx(x,{...c.customInstructionsDescription}),m=e.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[e.jsx("div",{className:"absolute h-full w-full rounded-full bg-token-main-surface-secondary opacity-5",style:{backgroundColor:o??void 0}}),e.jsx(A,{className:"icon-md h-5 w-5",style:{color:o}})]})):(i=e.jsx(x,{...c.editCustomInstructionsTitle}),p="overflow-hidden text-ellipsis whitespace-nowrap",u=n),e.jsx(Q,{isModalOpen:a,modal:l,onClick:d,header:i,context:u,icon:m,contextClassName:p})}const ye=B.h3`p4 overflow-hidden text-ellipsis break-all py-3 px-4 text-xs font-semibold text-token-text-secondary`,$s=B.div`h-24 w-full rounded-3xl bg-token-main-surface-secondary`,Js=()=>e.jsx("div",{className:"ml-1 mt-3 h-10",children:e.jsx("div",{className:"my-[15px] h-[10px] w-48 rounded-full bg-token-main-surface-secondary"})}),ne=new Map;function Ks(s){const n=ne.get(s);if(n)return n;const t=fs(qs,2e3,{trailing:!0});return ne.set(s,t),t}async function qs({gizmoId:s,upsertProjectMutation:n,toaster:t}){const o=gs,a=se(o.getState(),"theme",s);try{a!==void 0&&await n.mutateAsync({id:s,update:{theme:a??void 0}}),se(o.getState(),"theme",s)===a&&ps(s,"theme")}catch(r){const l=fe(r);t.warning(l??"Error",{duration:2})}}function et({gizmoId:s,theme:n,upsertProjectMutation:t,toaster:o}){hs(s,"theme",n),Ks(s)({gizmoId:s,upsertProjectMutation:t,toaster:o})}function st({gizmo:s}){const n=s.gizmo.display.emoji,t=Z(s.gizmo.id),o=as(),a=L(),[r,l]=h.useState(!1),d=V();if(o&&n)return e.jsx(is,{emoji:n,className:"icon-lg text-2xl"});const i=u=>{u!==t&&et({gizmoId:s.gizmo.id,theme:u,upsertProjectMutation:a,toaster:d})};return e.jsx(ls,{open:r,sideOffset:4,alignOffset:7,side:"bottom",alignAgainstAnchor:"start",size:"none",modal:!0,onOpenChange:u=>l(u),triggerButton:e.jsx(pe,{currentTheme:t,isPopoverOpen:r}),children:e.jsx(Ds,{currentTheme:t,onSelect:i})})}function tt({gizmo:s,clientThreadId:n}){const t=ts(),o="4o",{value:a}=Cs("408434742");return e.jsxs("div",{className:"mb-6 flex w-full flex-col px-4",children:[s?e.jsx(st,{gizmo:s}):e.jsx(pe,{disabled:!0,currentTheme:null,isPopoverOpen:!1}),s?e.jsxs("button",{className:"group ml-1 mt-3 self-start text-balance text-left text-4xl font-semibold hover:text-token-text-secondary",onClick:()=>{de.setShowProjectSettingsModal(!0)},children:[s.gizmo.display.name,e.jsx(A,{className:"icon-lg ml-2.5 inline-block text-token-text-secondary opacity-0 group-hover:opacity-100 motion-safe:transition-opacity motion-safe:duration-100"})]}):e.jsx(Js,{}),a&&s&&e.jsx("div",{className:"-ml-2 mt-1",children:ce(s)?e.jsx(Ts,{clientThreadId:n,inMobileHeader:t}):e.jsx("div",{className:"inline-block",children:e.jsx(ks,{label:e.jsx(x,{id:"u2Bz6Y",defaultMessage:"When using custom instructions or files, only GPT-4o is available"}),side:"right",children:e.jsxs(Es,{disabled:!0,children:[ns," ",o]})})})})]})}function Se({children:s}){return e.jsx("div",{className:"group relative flex flex-col gap-1 p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(cs,{className:"icon-md text-token-sidebar-icon"}),s]})})}function nt({conversation:s,gizmo:n}){const t=ws(s.id)??s.title,[o,a]=h.useState(!1);h.useEffect(()=>Is(ds,{editTitleInMainScreen:({serverThreadId:d})=>{d===s.id&&a(!0)}}),[s.id]);const{snippet:r}=s,l=e.jsxs(Se,{children:[e.jsxs("div",{className:"flex-grow overflow-hidden group-hover:mr-5",children:[o?e.jsx(ms,{conversation:s,onClose:()=>{a(!1)}}):e.jsx("div",{className:"text-sm font-medium",children:t}),r&&e.jsx("div",{className:"truncate text-sm text-token-text-secondary",children:r})]}),!o&&e.jsx(ot,{conversation:s})]});return o?l:e.jsx(Te,{to:us(s.id,n),children:l})}function ot({conversation:s}){const[n,t]=h.useState(!1);return e.jsx("div",{className:S("absolute bottom-0 top-0 items-center gap-1.5 pr-4 ltr:right-0 rtl:left-0",n?"flex":"hidden can-hover:group-hover:flex"),onClick:o=>{o.preventDefault()},children:e.jsx(xs,{conversation:s,conversationTitle:s.title,onOpenChange:o=>{t(o),o&&xe.logEvent(he.conversationHistoryItemOpenMenu,{conversationId:s.id})},inMainScreen:!0})})}function rt({gizmo:s}){os(s.gizmo.id);const{items:n,hasNextPage:t,fetchNextPage:o,isLoading:a,isFetching:r,isFetchingNextPage:l}=rs(s.gizmo.id),d=h.useRef(null),i=h.useCallback(m=>{a||m==null||(d.current?.disconnect(),d.current=new IntersectionObserver(p=>{p[0].isIntersecting&&t&&!r&&o()}),d.current.observe(m))},[a,t,o,r]);h.useEffect(()=>()=>{d.current?.disconnect()},[]);const u=n.length;return e.jsxs("div",{className:"mb-14 mt-6",children:[u||a?e.jsx(it,{gizmo:s,items:n??[],hasNextPage:t,infiniteScrollTriggerElementRef:i}):e.jsx(at,{}),l&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(ue,{})})]})}function at(){return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsx(x,{...c.emptyChatsInProjectTitle})}),e.jsx("ol",{children:Array.from({length:5}).map((n,t)=>e.jsx("li",{style:{opacity:1-t*.2,transition:"opacity 0.3s ease-in-out"},className:S(t!==4&&"border-b border-token-border-xlight"),children:e.jsx(Se,{children:e.jsxs("div",{className:"my-2 flex w-full flex-col gap-2",children:[e.jsx("div",{className:"h-2 w-2/12 rounded-full bg-token-main-surface-tertiary"}),e.jsx("div",{className:"h-2 w-5/12 rounded-full bg-token-main-surface-tertiary"})]})})},t))})]})}function it({gizmo:s,items:n,hasNextPage:t,infiniteScrollTriggerElementRef:o}){const a=n.length;return e.jsxs(e.Fragment,{children:[e.jsx(ye,{children:e.jsx(x,{...c.chatsInProjectTitle})}),e.jsx("ol",{children:n.map((r,l)=>{const d=t&&l===n.length-3?o:void 0;return e.jsx("li",{ref:d,className:S("first:rounded-t-lg last:rounded-b-lg hover:bg-token-main-surface-secondary",l!==a-1&&"border-b border-token-border-xlight"),children:e.jsx(nt,{conversation:r,gizmo:s})},r.id)})})]})}function yt({clientThreadId:s,gizmoId:n,currentModelId:t,onRequestCompletion:o}){const a=D(),{data:r}=Ke(n),l=qe(m=>m.showProjectSettingsModal),[d,i]=Pe(),u=r&&ce(r);return h.useEffect(()=>(u||(G.setThreadModelId(s,"gpt-4o"),G.lockThreadModel(s),i(m=>(m.delete("model"),m))),()=>{G.unlockThreadModel(s)}),[s,u,i]),e.jsxs(es,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:s,fullHeight:!0,children:[e.jsx(tt,{gizmo:r,clientThreadId:s}),r?e.jsx(Ps,{clientThreadId:s,isNewThread:!0,currentModelId:t,onRequestCompletion:o,hideHeader:!0,showPromptStarters:!1}):e.jsx($s,{}),e.jsx(Vs,{gizmo:r}),r&&e.jsx(rt,{gizmo:r}),l&&e.jsx(ss,{submitButtonTitle:a.formatMessage(c.projectSettingsSubmitButton),gizmo:r,onClose:()=>{de.setShowProjectSettingsModal(!1)}},n)]})}export{yt as SnorlaxSplashScreen};
//# sourceMappingURL=dqslqpg99u1nhq7x.js.map
